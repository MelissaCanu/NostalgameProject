@model Nostalgame.Models.Registrazione

@{
    ViewData["Title"] = "Details";
}

<h1 class="text-center">Dettagli utente</h1>

<div class="container">
    <div class="card regdet-card">
        <div class="card-header">
            <div class="d-flex flex-wrap align-items-center">

                    <a asp-action="EditDetails" asp-route-id="@Model.IdRegistrazione" class="btn btn-save">Modifica Dati Personali</a>
                </div>
                <div class="col-md-4">
                    @if (Model.Abbonamento.TipoAbbonamento != "Premium")
                    {
                        <a asp-action="Edit" asp-route-id="@Model.IdRegistrazione" class="btn btn-return">Effettua l'upgrade</a>
                    }
                    @if (Model.Abbonamento.TipoAbbonamento == "Premium")
                    {
                        <a href="#" class="btn btn-primary" id="downgradeButton">Torna a Standard</a>
                    }
                </div>
                <div class="col-md-4">
                    <a asp-action="ChangeUsernamePassword" class="btn btn-save">Cambia Username o Password</a>
                </div>
            </div>
        
    <div class="card-body">
        <hr />
        <dl class="row">
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Utente.UserName)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Utente.UserName)
            </dd><dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Nome)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Nome)
            </dd>
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Cognome)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Cognome)
            </dd>
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Indirizzo)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Indirizzo)
            </dd>
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Citta)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Citta)
            </dd>
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Email)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Email)
            </dd>
            @if (User.IsInRole("Admin"))
            {
                <dt class="col-sm-2">
                    @Html.DisplayNameFor(model => model.Utente)
                </dt>
                <dd class="col-sm-10">
                    @Html.DisplayFor(model => model.Utente.Id)
                </dd>
            }
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Abbonamento)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Abbonamento.TipoAbbonamento)
            </dd>
        </dl>
    </div>
</div>



    <div class="row mt-3">
        <div class="col-12">
            @if (User.IsInRole("Admin"))
            {
                <a asp-action="Index" class="btn btn-back">Indietro</a>
            }
            else
            {
                <a asp-action="Index" asp-controller="Home" class="btn btn-back">Torna alla Home</a>
            }
        </div>
    </div>
</div>


@section Scripts {
    <script type="text/javascript">
        document.getElementById("downgradeButton").addEventListener("click", function (event) {
            event.preventDefault();
            swal({
                title: "Sei sicuro?",
                text: "Se tornerai all'abbonamento Standard perderai tutti i privilegi di Premium, come la spedizione gratuita per tutti i noleggi",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
                .then((willDowngrade) => {
                    if (willDowngrade) {
                        window.location.href = '@Url.Action("Downgrade", new { id = Model.IdRegistrazione })';
                    }
                });
        });
    </script>
}